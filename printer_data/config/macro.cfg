[gcode_macro M81]
gcode:
 {action_call_remote_method("set_device_power",device="Printer Power",state="off")}

[gcode_macro PROBE_CALIBRATE]
gcode:     CARTOGRAPHER_CALIBRATE  # Command for calibration    

[gcode_macro BED_MESH_CALIBRATE]
rename_existing: _BED_MESH_CALIBRATE
gcode:
    {% set TARGET_TEMP = printer.heater_bed.target %}
    M140 S0
     _BED_MESH_CALIBRATE {rawparams}
    M140 S{TARGET_TEMP}
    

[gcode_macro QUAD_GANTRY_LEVEL]
rename_existing: _QUAD_GANTRY_LEVEL
gcode:
    SAVE_GCODE_STATE NAME=STATE_QGL
    BED_MESH_CLEAR
    {% set TARGET_TEMP = printer.heater_bed.target %}
    M140 S0
       
    {% if not printer.quad_gantry_level.applied %}
      _QUAD_GANTRY_LEVEL horizontal_move_z=10 retry_tolerance=1
    {% endif %}
    _QUAD_GANTRY_LEVEL horizontal_move_z=2
    G28 Z
    M140 S{TARGET_TEMP}
    
    RESTORE_GCODE_STATE NAME=STATE_QGL


#####################################################################
#  GitHub ìë™ ë°±ì—… ë§¤í¬ë¡œ (by ë¯¸ë‚˜ ğŸ•µï¸â€â™‚ï¸)
#####################################################################

[gcode_shell_command backup_cfg]
command: /usr/bin/bash /home/pi/klipper-backup/script.sh  # ìŠ¤í¬ë¦½íŠ¸ ê²½ë¡œ í™•ì¸ í•„ìš”!
timeout: 30.
verbose: True

[gcode_macro BACKUP_CFG]
description: í˜„ì¬ ì„¤ì •ì„ GitHub(main2)ë¡œ ë°±ì—…í•©ë‹ˆë‹¤.
gcode:
    RESPOND MSG="700ì´ ì„¤ì •ì„ GitHub(main2)ë¡œ ë°±ì—… ì¤‘..."
    RUN_SHELL_COMMAND CMD=backup_cfg
    RESPOND MSG="ë°±ì—… ìš”ì²­ ì™„ë£Œ!" 

[gcode_macro SAVE_AND_BACKUP]
description: ì„¤ì •ì„ ì €ì¥í•˜ê³  ì¦‰ì‹œ main2 ë¸ŒëŸ°ì¹˜ë¡œ ë°±ì—…í•©ë‹ˆë‹¤.
gcode:
    # ì„¤ì •ì„ ì €ì¥í•˜ê¸° ì „ì— ë°±ì—…ì„ ë¨¼ì € ì‹¤í–‰í•©ë‹ˆë‹¤. 
    # (SAVE_CONFIGëŠ” ì¦‰ì‹œ ì¬ì‹œì‘ì„ ìœ ë°œí•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤)
    BACKUP_CFG
    SAVE_CONFIG

